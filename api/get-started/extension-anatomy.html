<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Extension Anatomy | Vscode API 中文文档</title>
    <meta name="description" content="Just playing around">
    
    
    <link rel="preload" href="/assets/css/0.styles.454f99c0.css" as="style"><link rel="preload" href="/assets/js/app.69530766.js" as="script"><link rel="preload" href="/assets/js/2.6081b710.js" as="script"><link rel="preload" href="/assets/js/31.71b1efc9.js" as="script"><link rel="prefetch" href="/assets/js/10.00c1caf2.js"><link rel="prefetch" href="/assets/js/11.22f75b2f.js"><link rel="prefetch" href="/assets/js/12.33618473.js"><link rel="prefetch" href="/assets/js/13.f5bcdba3.js"><link rel="prefetch" href="/assets/js/14.069ed78b.js"><link rel="prefetch" href="/assets/js/15.8ad5337f.js"><link rel="prefetch" href="/assets/js/16.27611e97.js"><link rel="prefetch" href="/assets/js/17.f0ee6d17.js"><link rel="prefetch" href="/assets/js/18.4a6eb331.js"><link rel="prefetch" href="/assets/js/19.43e4541f.js"><link rel="prefetch" href="/assets/js/20.7de46031.js"><link rel="prefetch" href="/assets/js/21.84669414.js"><link rel="prefetch" href="/assets/js/22.9afacd9c.js"><link rel="prefetch" href="/assets/js/23.f216dfdc.js"><link rel="prefetch" href="/assets/js/24.0cc96f6f.js"><link rel="prefetch" href="/assets/js/25.cbd514e8.js"><link rel="prefetch" href="/assets/js/26.7be766a8.js"><link rel="prefetch" href="/assets/js/27.c82f8665.js"><link rel="prefetch" href="/assets/js/28.14ff35c2.js"><link rel="prefetch" href="/assets/js/29.0b9194ef.js"><link rel="prefetch" href="/assets/js/3.3c269ca0.js"><link rel="prefetch" href="/assets/js/30.eb394ebe.js"><link rel="prefetch" href="/assets/js/32.a260662e.js"><link rel="prefetch" href="/assets/js/33.ebd1b0e9.js"><link rel="prefetch" href="/assets/js/34.8c89ccc9.js"><link rel="prefetch" href="/assets/js/35.8c56c023.js"><link rel="prefetch" href="/assets/js/36.bb77a714.js"><link rel="prefetch" href="/assets/js/37.fff25a6d.js"><link rel="prefetch" href="/assets/js/38.c898d862.js"><link rel="prefetch" href="/assets/js/39.3c1938ed.js"><link rel="prefetch" href="/assets/js/4.8ce84c45.js"><link rel="prefetch" href="/assets/js/40.08340174.js"><link rel="prefetch" href="/assets/js/41.022c4327.js"><link rel="prefetch" href="/assets/js/42.a6524d2e.js"><link rel="prefetch" href="/assets/js/43.8f0dd455.js"><link rel="prefetch" href="/assets/js/44.b23d9f65.js"><link rel="prefetch" href="/assets/js/45.a30b757b.js"><link rel="prefetch" href="/assets/js/46.789e9716.js"><link rel="prefetch" href="/assets/js/47.33d6f209.js"><link rel="prefetch" href="/assets/js/48.135250ff.js"><link rel="prefetch" href="/assets/js/49.3d6d3bb5.js"><link rel="prefetch" href="/assets/js/5.62e47b4c.js"><link rel="prefetch" href="/assets/js/50.44990f04.js"><link rel="prefetch" href="/assets/js/51.2a2a5129.js"><link rel="prefetch" href="/assets/js/52.3996bfd7.js"><link rel="prefetch" href="/assets/js/53.01d6e216.js"><link rel="prefetch" href="/assets/js/54.ec31b688.js"><link rel="prefetch" href="/assets/js/55.25e75232.js"><link rel="prefetch" href="/assets/js/6.83a6b4a3.js"><link rel="prefetch" href="/assets/js/7.1f83f4dc.js"><link rel="prefetch" href="/assets/js/8.db84d1e9.js"><link rel="prefetch" href="/assets/js/9.6259a5ab.js">
    <link rel="stylesheet" href="/assets/css/0.styles.454f99c0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-navbar"><!----> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/" class="sidebar-link">首页</a></li><li><a href="/api/" class="sidebar-link">扩展 API</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="extension-anatomy"><a href="#extension-anatomy" aria-hidden="true" class="header-anchor">#</a> Extension Anatomy</h1> <p>In the last topic, you were able to get a basic extension running. How does it work under the hood?</p> <p>The <code>Hello World</code> extension does 3 things:</p> <ul><li>Registers the <a href="/api/references/activation-events#onCommand"><code>onCommand</code></a> <a href="/api/references/activation-events"><strong>Activation Event</strong></a>: <code>onCommand:extension.helloWorld</code>, so the extension becomes activated when user runs the <code>Hello World</code> command.</li> <li>Uses the <a href="/api/references/contribution-points#contributes.commands"><code>contributes.commands</code></a> <a href="/api/references/contribution-points"><strong>Contribution Point</strong></a> to make the command <code>Hello World</code> available in the Command Palette, and bind it to a command ID <code>extension.helloWorld</code>.</li> <li>Uses the <a href="/api/references/vscode-api#commands.registerCommand"><code>commands.registerCommand</code></a> <a href="/api/references/vscode-api"><strong>VS Code API</strong></a> to bind a function to the registered command ID <code>extension.helloWorld</code>.</li></ul> <p>Understanding these three concepts is crucial to writing extensions in VS Code:</p> <ul><li><a href="/api/references/activation-events"><strong>Activation Events</strong></a>: events upon which your extension becomes active.</li> <li><a href="/api/references/contribution-points"><strong>Contribution Points</strong></a>: static declarations that you make in the <code>package.json</code> <a href="#extension-manifest">Extension Manifest</a> to extend VS Code.</li> <li><a href="/api/references/vscode-api"><strong>VS Code API</strong></a>: a set of JavaScript API that you can invoke in your extension code.</li></ul> <p>In general, your extension would use a combination of Contribution Points and VS Code API to extend VS Code's functionality. The <a href="/api/extension-capabilities/overview">Extension Capabilities Overview</a> topic helps you find the right Contribution Point and VS Code API for your extension.</p> <p>Let's take a closer look of <code>Hello World</code> sample's source code and see how these concepts apply to it.</p> <h2 id="extension-file-structure"><a href="#extension-file-structure" aria-hidden="true" class="header-anchor">#</a> Extension File Structure</h2> <div class="language- extra-class"><pre class="language-text"><code>.
├── .vscode
│   ├── launch.json     // Config for launching and debugging the extension
│   └── tasks.json      // Config for build task that compiles TypeScript
├── .gitignore          // Ignore build output and node_modules
├── README.md           // Readable description of your extension's functionality
├── src
│   └── extension.ts    // Extension source code
├── package.json        // Extension manifest
├── tsconfig.json       // TypeScript configuration
</code></pre></div><p>You can read more about the configuration files:</p> <ul><li><code>launch.json</code> used to configure VS Code <a href="/docs/editor/debugging">Debugging</a></li> <li><code>tasks.json</code> for defining VS Code <a href="/docs/editor/tasks">Tasks</a></li> <li><code>tsconfig.json</code> consult the TypeScript <a href="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html" target="_blank" rel="noopener noreferrer">Handbook<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>However, let's focus on <code>package.json</code> and <code>extensions.ts</code>, which are essential to understanding the <code>Hello World</code> extension.</p> <h3 id="extension-manifest"><a href="#extension-manifest" aria-hidden="true" class="header-anchor">#</a> Extension Manifest</h3> <p>Each VS Code extension must have a <code>package.json</code> as its <a href="/api/references/extension-manifest">Extension Manifest</a>. The <code>package.json</code> contains a mix of Node.js fields such as <code>scripts</code> and <code>dependencies</code> and VS Code specific fields such as <code>publisher</code>, <code>activationEvents</code> and <code>contributes</code>. You can find description of all VS Code specific fields in <a href="/api/references/extension-manifest">Extension Manifest Reference</a>. Here are some most important fields:</p> <ul><li><code>name</code> and <code>publisher</code>: VS Code uses <code>&lt;publisher&gt;.&lt;name&gt;</code> as a unique ID for the extension. For example, the Hello World sample has the ID <code>vscode-samples.helloworld-sample</code>. VS Code uses the ID to uniquely identify your extension</li> <li><code>main</code>: The extension entry point.</li> <li><code>activationEvents</code> and <code>contributes</code>: <a href="/api/references/activation-events">Activation Events</a> and <a href="/api/references/contribution-points">Contribution Points</a>.</li> <li><code>engines.vscode</code>: This specifies the minimum version of VS Code API that the extension depends on.</li> <li>The <code>postinstall</code> script: This would install the 1.34.0 version of VS Code API as specified in <code>engines.vscode</code>. Once the <code>vscode.d.ts</code> file is downloaded to <code>node_modules/vscode/vscode.d.ts</code>, you will get IntelliSense, jump to definition and error checking for all usage of VS Code API.</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;helloworld-sample&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;displayName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;helloworld-sample&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HelloWorld example for VS Code&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0.1&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;publisher&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vscode-samples&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;repository&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://github.com/Microsoft/vscode-extension-samples/helloworld-sample&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;engines&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;vscode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.34.0&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;categories&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;Other&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;activationEvents&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;onCommand:extension.helloWorld&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./out/extension.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;contributes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;commands&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;command&quot;</span><span class="token operator">:</span> <span class="token string">&quot;extension.helloWorld&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Hello World&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;vscode:prepublish&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run compile&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;compile&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tsc -p ./&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;watch&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tsc -watch -p ./&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;postinstall&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node ./node_modules/vscode/bin/install&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@types/node&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^8.10.25&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@types/vscode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.34.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;tslint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.16.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;typescript&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.4.5&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="extension-entry-file"><a href="#extension-entry-file" aria-hidden="true" class="header-anchor">#</a> Extension Entry File</h2> <p>The extension entry file exports two functions, <code>activate</code> and <code>deactivate</code>. <code>activate</code> is executed when your registered <strong>Activation Event</strong> happens. <code>deactivate</code> gives you a chance to clean up before your extension becomes deactivated.</p> <p>The <a href="https://www.npmjs.com/package/vscode" target="_blank" rel="noopener noreferrer"><code>vscode</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> module contains a script located at <code>node ./node_modules/vscode/bin/install</code>. The script pulls the VS Code API definition file depending on the <code>engines.vscode</code> field in <code>package.json</code>. After running the script, you would get IntelliSense, jump to definition and other TypeScript language features in your code.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// The module 'vscode' contains the VS Code extensibility API</span>
<span class="token comment">// Import the module and reference it with the alias vscode in your code below</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> vscode <span class="token keyword">from</span> <span class="token string">'vscode'</span><span class="token punctuation">;</span>

<span class="token comment">// this method is called when your extension is activated</span>
<span class="token comment">// your extension is activated the very first time the command is executed</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">activate</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">:</span> vscode<span class="token punctuation">.</span>ExtensionContext</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Use the console to output diagnostic information (console.log) and errors (console.error)</span>
  <span class="token comment">// This line of code will only be executed once when your extension is activated</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Congratulations, your extension &quot;helloworld-sample&quot; is now active!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// The command has been defined in the package.json file</span>
  <span class="token comment">// Now provide the implementation of the command with registerCommand</span>
  <span class="token comment">// The commandId parameter must match the command field in package.json</span>
  <span class="token keyword">let</span> disposable <span class="token operator">=</span> vscode<span class="token punctuation">.</span>commands<span class="token punctuation">.</span><span class="token function">registerCommand</span><span class="token punctuation">(</span><span class="token string">'extension.helloWorld'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// The code you place here will be executed every time your command is executed</span>

    <span class="token comment">// Display a message box to the user</span>
    vscode<span class="token punctuation">.</span>window<span class="token punctuation">.</span><span class="token function">showInformationMessage</span><span class="token punctuation">(</span><span class="token string">'Hello World!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  context<span class="token punctuation">.</span>subscriptions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>disposable<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// this method is called when your extension is deactivated</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">deactivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.69530766.js" defer></script><script src="/assets/js/2.6081b710.js" defer></script><script src="/assets/js/31.71b1efc9.js" defer></script>
  </body>
</html>
