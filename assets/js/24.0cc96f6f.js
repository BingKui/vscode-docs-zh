(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{221:function(t,e,s){"use strict";s.r(e);var a=s(0),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"source-control-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#source-control-api","aria-hidden":"true"}},[t._v("#")]),t._v(" Source Control API")]),t._v(" "),s("p",[t._v("The Source Control API allows extension authors to define Source Control Management (SCM) features. There is a slim, yet powerful API surface which allows many different SCM systems to be integrated in Visual Studio Code, while having a common user interface with all of them.")]),t._v(" "),s("p",[s("img",{attrs:{src:"images/scm-provider/main.png",alt:"VS Code SCM"}})]),t._v(" "),s("p",[t._v("VS Code itself ships with one Source Control provider, the Git extension, which is the best reference for this API and is "),s("a",{attrs:{href:"https://github.com/Microsoft/vscode/blob/master/extensions/git/src/repository.ts",target:"_blank",rel:"noopener noreferrer"}},[t._v("a great starting point"),s("OutboundLink")],1),t._v(" if you'd like to contribute your very own SCM provider. There are other great examples in the Marketplace such as the "),s("a",{attrs:{href:"https://marketplace.visualstudio.com/items?itemName=johnstoncode.svn-scm",target:"_blank",rel:"noopener noreferrer"}},[t._v("SVN extension"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[t._v("This documentation will help you build an extension which can make any SCM system work with VS Code.")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("Note:")]),t._v(" that you can always refer to the "),s("a",{attrs:{href:"/api/references/vscode-api#scm"}},[s("code",[t._v("vscode")]),t._v(" namespace API reference")]),t._v(" in our documentation.")])]),t._v(" "),s("h2",{attrs:{id:"source-control-model"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#source-control-model","aria-hidden":"true"}},[t._v("#")]),t._v(" Source Control Model")]),t._v(" "),s("p",[t._v("A "),s("code",[t._v("SourceControl")]),t._v(" is the entity responsible for populating the Source Control model with "),s("strong",[t._v("resource states")]),t._v(", instances of "),s("code",[t._v("SourceControlResourceState")]),t._v(". Resource states are themselves organized in "),s("strong",[t._v("groups")]),t._v(", instances of "),s("code",[t._v("SourceControlResourceGroup")]),t._v(".")]),t._v(" "),s("p",[t._v("You can create a new SourceControl with "),s("code",[t._v("vscode.scm.createSourceControl")]),t._v(".")]),t._v(" "),s("p",[t._v("In order to better understand how these three entities correlate with each other, let's take "),s("a",{attrs:{href:"https://github.com/Microsoft/vscode/tree/master/extensions/git",target:"_blank",rel:"noopener noreferrer"}},[t._v("Git"),s("OutboundLink")],1),t._v(" as an example. Consider the following output of "),s("code",[t._v("git status")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("vsce master* → "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" status\nOn branch master\nYour branch is up-to-date with "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'origin/master'")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\nChanges to be committed:\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("use "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"git reset HEAD <file>..."')]),t._v(" to unstage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        modified:   README.md\n        renamed:    src/api.ts -"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" src/test/api.ts\n\nChanges not staged "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" commit:\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("use "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"git add/rm <file>..."')]),t._v(" to update what will be committed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("use "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"git checkout -- <file>..."')]),t._v(" to discard changes "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" working directory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        deleted:    .travis.yml\n        modified:   README.md\n")])])]),s("p",[t._v("There are many things going on in this workspace. First, the "),s("code",[t._v("README.md")]),t._v(" file has been modified, staged and then modified once again. Second, the "),s("code",[t._v("src/api.ts")]),t._v(" file has been moved to "),s("code",[t._v("src/test/api.ts")]),t._v(" and that move was staged. Finally, the "),s("code",[t._v(".travis.yml")]),t._v(" file has been deleted.")]),t._v(" "),s("p",[t._v("For this workspace, Git defines two resource groups: the "),s("strong",[t._v("working tree")]),t._v(" and the "),s("strong",[t._v("index")]),t._v(". Each "),s("strong",[t._v("file change")]),t._v(" within that group is "),s("strong",[t._v("resource state")]),t._v(":")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Index")]),t._v(" - resource group\n"),s("ul",[s("li",[s("code",[t._v("README.md")]),t._v(", modified - resource state")]),t._v(" "),s("li",[s("code",[t._v("src/test/api.ts")]),t._v(", renamed from "),s("code",[t._v("src/api.ts")]),t._v(" - resource state")])])]),t._v(" "),s("li",[s("strong",[t._v("Working Tree")]),t._v(" - resource group\n"),s("ul",[s("li",[s("code",[t._v(".travis.yml")]),t._v(", deleted - resource state")]),t._v(" "),s("li",[s("code",[t._v("README.md")]),t._v(", modified - resource state")])])])]),t._v(" "),s("p",[t._v("Note how the same file, "),s("code",[t._v("README.md")]),t._v(", is part of two distinct resource states.")]),t._v(" "),s("p",[t._v("Here's how Git creates this model:")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createResourceUri")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("relativePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Uri "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" absolutePath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("workspace"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rootPath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" relativePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Uri"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("absolutePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" gitSCM "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createSourceControl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'git'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Git'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" index "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" gitSCM"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createResourceGroup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'index'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Index'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nindex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("resourceStates "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" resourceUri"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createResourceUri")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'README.md'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" resourceUri"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createResourceUri")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'src/test/api.ts'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" workingTree "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" gitSCM"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createResourceGroup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'workingTree'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Changes'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nworkingTree"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("resourceStates "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" resourceUri"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createResourceUri")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.travis.yml'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" resourceUri"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createResourceUri")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'README.md'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Changes made to the source control and resource groups will be propagated to the Source Control view.")]),t._v(" "),s("h2",{attrs:{id:"source-control-view"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#source-control-view","aria-hidden":"true"}},[t._v("#")]),t._v(" Source Control View")]),t._v(" "),s("p",[t._v("VS Code is able to populate the Source Control view, as the Source Control model changes. Resource states are customizable using "),s("code",[t._v("SourceControlResourceDecorations")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SourceControlResourceState")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("readonly")]),t._v(" decorations"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" SourceControlResourceDecorations"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("The previous example would be sufficient to populate a simple list in the Source Control view, but there are many user interactions that the user might want to perform with each resource. For instance, what happens when the user clicks a resource state? The resource state can optionally provide a command to handle this action:")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SourceControlResourceState")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("readonly")]),t._v(" command"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"menus"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#menus","aria-hidden":"true"}},[t._v("#")]),t._v(" Menus")]),t._v(" "),s("p",[t._v("There are five Source Control menu ids where you can place menu items, in order to provide the user with a much richer user interface.")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("scm/title")]),t._v(" menu is located to the right of the SCM view title. The menu items in the "),s("code",[t._v("navigation")]),t._v(" group will be inline, while all the others will be within the "),s("code",[t._v("…")]),t._v(" drop-down menu.")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("scm/resourceGroup/context")]),t._v(" and "),s("code",[t._v("scm/resourceState/context")]),t._v(" are similar. The former will let you customize resource groups, while the later refers to resource states. Place menu items in the "),s("code",[t._v("inline")]),t._v(" group to have them inline. All other menu item groups will be represented in a context menu usually accessible using the mouse right-click. Commands called from within these menus will have the respective resource states on passed as arguments. Note that the SCM view supports multiple selection thus a command might receive more than one resource at a time in its arguments.")]),t._v(" "),s("p",[t._v("For example, Git supports staging multiple files by adding the "),s("code",[t._v("git.stage")]),t._v(" command to the "),s("code",[t._v("scm/resourceState/context")]),t._v(" menu and using such a method declaration:")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("resourceStates"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" SourceControlResourceState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Promise")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("When creating them, "),s("code",[t._v("SourceControl")]),t._v(" and "),s("code",[t._v("SourceControlResourceGroup")]),t._v(" instances require you to provide an "),s("code",[t._v("id")]),t._v(" string. These values will be populated in the "),s("code",[t._v("scmProvider")]),t._v(" and "),s("code",[t._v("scmResourceGroup")]),t._v(" context keys, respectively. You can rely on these "),s("a",{attrs:{href:"/docs/getstarted/keybindings#_when-clause-contexts"}},[t._v("context keys")]),t._v(" in the "),s("code",[t._v("when")]),t._v(" clauses of your menu items. Here's how Git is able to show a menu item for its "),s("code",[t._v("git.stage")]),t._v(" command:")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"command"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"git.stage"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"when"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"scmProvider == git && scmResourceGroup == merge"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"group"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"inline"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("The "),s("code",[t._v("scm/change/title")]),t._v(" allows you to contribute commands to the title bar of an inline change. The command will be passed as arguments the URI of the document, the array of changes within it, and the index of the change which the inline change affordance is currently focused on. For example, here's the declaration of the "),s("code",[t._v("stageChange")]),t._v(" Git command, which is contributed to this menu:")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stageChange")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uri"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Uri"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" changes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" LineChange"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("number")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Promise")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("The "),s("code",[t._v("scm/sourceControl")]),t._v(" menu is located contextually near SourceControl instances:")]),t._v(" "),s("p",[s("img",{attrs:{src:"images/scm-provider/sourcecontrol-menu.png",alt:"source control menu"}})]),t._v(" "),s("p",[t._v("Finally, the "),s("code",[t._v("scm/change/title")]),t._v(" menu is related to the Quick Diff experience, showcased further ahead. It lets you contribute commands which are specific to code changes.")]),t._v(" "),s("h3",{attrs:{id:"scm-input-box"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#scm-input-box","aria-hidden":"true"}},[t._v("#")]),t._v(" SCM Input Box")]),t._v(" "),s("p",[t._v("The Source Control Input Box, located atop of each Source Control view, allows the user to input a message. You can get (and set) this message in order to perform operations. In Git, for example, this is used as the commit box, in which users type in commit messages and "),s("code",[t._v("git commit")]),t._v(" commands pick them up.")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SourceControlInputBox")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SourceControl")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("readonly")]),t._v(" inputBox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" SourceControlInputBox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("The user can type "),s("kbd",[t._v("Ctrl+Enter")]),t._v(" (or "),s("kbd",[t._v("Cmd+Enter")]),t._v(" on macOS) to accept any message. You can handle this event by providing a "),s("code",[t._v("acceptInputCommand")]),t._v(" to your "),s("code",[t._v("SourceControl")]),t._v(" instance.")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SourceControl")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("readonly")]),t._v(" acceptInputCommand"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"quick-diff"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#quick-diff","aria-hidden":"true"}},[t._v("#")]),t._v(" Quick Diff")]),t._v(" "),s("p",[t._v("VS Code also supports displaying "),s("strong",[t._v("quick diff")]),t._v(" editor gutter decorations. Clicking those decorations will reveal an inline diff experience, to which you can contribute contextual commands:")]),t._v(" "),s("p",[s("img",{attrs:{src:"images/scm-provider/quickdiff.png",alt:"SCM quick diff"}})]),t._v(" "),s("p",[t._v("These decorations are computed by VS Code itself. All you need to do is provide VS Code with the original contents of any given file.")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SourceControl")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  quickDiffProvider"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" QuickDiffProvider"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("Using a "),s("code",[t._v("QuickDiffProvider")]),t._v(", your implementation is able to tell VS Code what's the "),s("code",[t._v("Uri")]),t._v(" of the original resource that matches the resource which "),s("code",[t._v("Uri")]),t._v(" is provided as an argument.")]),t._v(" "),s("p",[t._v("You can combine this API with the "),s("a",{attrs:{href:"/api/references/vscode-api#workspace"}},[s("code",[t._v("registerTextDocumentContentProvider")]),t._v(" method in the "),s("code",[t._v("workspace")]),t._v(" namespace")]),t._v(", which lets you provide contents for arbitrary resources, given a "),s("code",[t._v("Uri")]),t._v(".")]),t._v(" "),s("h2",{attrs:{id:"next-steps"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#next-steps","aria-hidden":"true"}},[t._v("#")]),t._v(" Next steps")]),t._v(" "),s("p",[t._v("To learn more about VS Code extensibility model, try these topics:")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"/api/references/vscode-api#scm"}},[t._v("SCM API Reference")]),t._v(" - Read the full SCM API documentation")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/Microsoft/vscode/tree/master/extensions/git",target:"_blank",rel:"noopener noreferrer"}},[t._v("Git Extension"),s("OutboundLink")],1),t._v(" - Learn by reading the Git extension implementation")]),t._v(" "),s("li",[s("a",{attrs:{href:"/api"}},[t._v("Extension API Overview")]),t._v(" - Learn about the full VS Code extensibility model.")]),t._v(" "),s("li",[s("a",{attrs:{href:"/api/references/extension-manifest"}},[t._v("Extension Manifest File")]),t._v(" - VS Code package.json extension manifest file reference")]),t._v(" "),s("li",[s("a",{attrs:{href:"/api/references/contribution-points"}},[t._v("Contribution Points")]),t._v(" - VS Code contribution points reference")])])])}),[],!1,null,null,null);e.default=n.exports}}]);