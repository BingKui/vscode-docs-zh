(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{218:function(e,t,n){"use strict";n.r(t);var s=n(0),a=Object(s.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"bundling-extension"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#bundling-extension","aria-hidden":"true"}},[e._v("#")]),e._v(" Bundling Extension")]),e._v(" "),n("p",[e._v("Visual Studio Code extensions often grow quickly in size. They are authored in multiple source files and depend on modules from "),n("a",{attrs:{href:"https://www.npmjs.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("npm"),n("OutboundLink")],1),e._v(". Decomposition and reuse are development best practices but they come at a cost when installing and running extensions. Loading 100 small files is much slower than loading one large file. That's why we recommend bundling. Bundling is the process of combining multiple small source files into a single file.")]),e._v(" "),n("p",[e._v("For JavaScript, different bundlers are available. Popular ones are "),n("a",{attrs:{href:"https://rollupjs.org",target:"_blank",rel:"noopener noreferrer"}},[e._v("rollup.js"),n("OutboundLink")],1),e._v(", "),n("a",{attrs:{href:"https://parceljs.org",target:"_blank",rel:"noopener noreferrer"}},[e._v("Parcel"),n("OutboundLink")],1),e._v(", and "),n("a",{attrs:{href:"https://webpack.js.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("webpack"),n("OutboundLink")],1),e._v(". This tutorial will focus on "),n("strong",[e._v("webpack")]),e._v(", however, concepts and benefits of all bundlers are similar.")]),e._v(" "),n("h2",{attrs:{id:"using-webpack"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#using-webpack","aria-hidden":"true"}},[e._v("#")]),e._v(" Using webpack")]),e._v(" "),n("p",[e._v("Webpack is a development tool that's available from "),n("a",{attrs:{href:"https://www.npmjs.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("npm"),n("OutboundLink")],1),e._v(". To acquire webpack and its command line interface, open the terminal and type:")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" i --save-dev webpack webpack-cli\n")])])]),n("p",[e._v("This will install webpack and update your extension's "),n("code",[e._v("package.json")]),e._v(" file to include webpack in the "),n("code",[e._v("devDependencies")]),e._v(". Webpack is a JavaScript bundler but many VS Code extensions are written in TypeScript and only compiled to JavaScript. With the help of a loader "),n("code",[e._v("ts-loader")]),e._v(", webpack can understand TypeScript. Use the following to install "),n("code",[e._v("ts-loader")]),e._v(":")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("npm")]),e._v(" i --save-dev ts-loader\n")])])]),n("h2",{attrs:{id:"configure-webpack"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#configure-webpack","aria-hidden":"true"}},[e._v("#")]),e._v(" Configure webpack")]),e._v(" "),n("p",[e._v("With all tools installed, webpack can now be configured. By convention, a "),n("code",[e._v("webpack.config.js")]),e._v(" file contains the configuration to instruct webpack to bundle your extension. The sample configuration below is for VS Code extensions and should provide a good starting point:")]),e._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("//@ts-check")]),e._v("\n\n"),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'use strict'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" path "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("/**@type {import('webpack').Configuration}*/")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" config "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    target"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'node'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// vscode extensions run in a Node.js-context ðŸ“– -> https://webpack.js.org/configuration/node/")]),e._v("\n\n    entry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'./src/extension.ts'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// the entry point of this extension, ðŸ“– -> https://webpack.js.org/configuration/entry-context/")]),e._v("\n    output"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// the bundle is stored in the 'dist' folder (check package.json), ðŸ“– -> https://webpack.js.org/configuration/output/")]),e._v("\n        path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("resolve")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'dist'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        filename"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'extension.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        libraryTarget"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"commonjs2"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        devtoolModuleFilenameTemplate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"../[resource-path]"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    devtool"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'source-map'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    externals"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        vscode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"commonjs vscode"')]),e._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// the vscode-module is created on-the-fly and must be excluded. Add other modules that cannot be webpack'ed, ðŸ“– -> https://webpack.js.org/configuration/externals/")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    resolve"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// support reading TypeScript and JavaScript files, ðŸ“– -> https://github.com/TypeStrong/ts-loader")]),e._v("\n        extensions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'.ts'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    module"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        rules"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n            test"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[e._v("/\\.ts$/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            exclude"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[e._v("/node_modules/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            use"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n                loader"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'ts-loader'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" config"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),n("p",[e._v("The file is "),n("a",{attrs:{href:"https://github.com/Microsoft/vscode-extension-samples/blob/master/webpack-sample/webpack.config.js",target:"_blank",rel:"noopener noreferrer"}},[e._v("available"),n("OutboundLink")],1),e._v(" as part of the "),n("a",{attrs:{href:"https://github.com/Microsoft/vscode-extension-samples/blob/master/webpack-sample",target:"_blank",rel:"noopener noreferrer"}},[e._v("webpack-extension"),n("OutboundLink")],1),e._v(" sample. Webpack configuration files are normal JavaScript modules that must export a configuration object.")]),e._v(" "),n("p",[e._v("In the sample above, the following are defined:")]),e._v(" "),n("ul",[n("li",[e._v("The "),n("code",[e._v("target")]),e._v(" is 'node' because extensions run in a Node.js context.")]),e._v(" "),n("li",[e._v("The entry point webpack should use. This is similar to the "),n("code",[e._v("main")]),e._v(" property in "),n("code",[e._v("package.json")]),e._v(' except that you provide webpack with a "source" entry point, usually '),n("code",[e._v("src/extension.ts")]),e._v(', and not an "output" entry point. The webpack bundler understands TypeScript, so a separate TypeScript compile step is redundant.')]),e._v(" "),n("li",[e._v("The "),n("code",[e._v("output")]),e._v(" configuration tells webpack where to place the generated bundle file. By convention, that is the "),n("code",[e._v("dist")]),e._v(" folder. In this sample, webpack will produce a "),n("code",[e._v("dist/extension.js")]),e._v(" file.")]),e._v(" "),n("li",[e._v("The "),n("code",[e._v("resolve")]),e._v(" and "),n("code",[e._v("module/rules")]),e._v(" configurations are there to support TypeScript and JavaScript input files.")]),e._v(" "),n("li",[e._v("The "),n("code",[e._v("externals")]),e._v(" configuration is used to declare exclusions, for example files and modules that should not be included in the bundle. The "),n("code",[e._v("vscode")]),e._v(" module should not be bundled because it doesn't exist on disk but is created by VS Code on-the-fly when required. Depending on the node modules that an extension uses, more exclusion may be necessary.")])]),e._v(" "),n("h2",{attrs:{id:"run-webpack"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#run-webpack","aria-hidden":"true"}},[e._v("#")]),e._v(" Run webpack")]),e._v(" "),n("p",[e._v("With the "),n("code",[e._v("webpack.config.js")]),e._v(" file created, webpack can be invoked. You can run webpack from the command line but to reduce repetition, using npm scripts is helpful.")]),e._v(" "),n("p",[e._v("Merge these entries into the "),n("code",[e._v("scripts")]),e._v(" section in "),n("code",[e._v("package.json")]),e._v(":")]),e._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"scripts"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"vscode:prepublish"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"webpack --mode production"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"webpack"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"webpack --mode development"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"webpack-dev"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"webpack --mode development --watch"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"test-compile"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"tsc -p ./"')]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n")])])]),n("p",[e._v("The "),n("code",[e._v("webpack")]),e._v(" and "),n("code",[e._v("webpack-dev")]),e._v(" scripts are for development and they produce the bundle file. The "),n("code",[e._v("vscode:prepublish")]),e._v(" is used by "),n("code",[e._v("vsce")]),e._v(", the VS Code packaging and publishing tool, and run before publishing an extension. The difference is in the "),n("a",{attrs:{href:"https://webpack.js.org/concepts/mode/",target:"_blank",rel:"noopener noreferrer"}},[e._v("mode"),n("OutboundLink")],1),e._v(" and that controls the level of optimization. Using "),n("code",[e._v("production")]),e._v(" yields the smallest bundle but also takes longer, so else "),n("code",[e._v("development")]),e._v(" is used. To run above scripts, open a terminal and type "),n("code",[e._v("npm run webpack")]),e._v(" or select "),n("strong",[e._v("Tasks: Run Task")]),e._v(" from the Command Palette ("),n("code",[e._v("kb(workbench.action.showCommands)")]),e._v(").")]),e._v(" "),n("h2",{attrs:{id:"run-the-extension"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#run-the-extension","aria-hidden":"true"}},[e._v("#")]),e._v(" Run the extension")]),e._v(" "),n("p",[e._v("Before you can run the extension, the "),n("code",[e._v("main")]),e._v(" property in "),n("code",[e._v("package.json")]),e._v(" must point to the bundle, which for the configuration above is "),n("a",{attrs:{href:"https://github.com/Microsoft/vscode-references-view/blob/d649d01d369e338bbe70c86e03f28269cbf87027/package.json#L26",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v('"./dist/extension"')]),n("OutboundLink")],1),e._v(". With that change, the extension can now be executed and tested. For debugging configuration, make sure to update the "),n("code",[e._v("outFiles")]),e._v(" property in the "),n("code",[e._v("launch.json")]),e._v(" file.")]),e._v(" "),n("h2",{attrs:{id:"tests"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tests","aria-hidden":"true"}},[e._v("#")]),e._v(" Tests")]),e._v(" "),n("p",[e._v("Extension authors often write unit tests for their extension source code. With the correct architectural layering, where the extension source code doesn't depend on tests, the webpack produced bundle shouldn't contain any test code. To run unit tests, only a simple compile is necessary. In the sample, there is a "),n("code",[e._v("test-compile")]),e._v(" script, which uses the TypeScript compiler to compile the extension into the "),n("code",[e._v("out")]),e._v(" folder. With that intermediate JavaScript available, the following snippet for "),n("code",[e._v("launch.json")]),e._v(" is enough to run tests.")]),e._v(" "),n("div",{staticClass:"language-json extra-class"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Extension Tests"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"type"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"extensionHost"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"request"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"launch"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"runtimeExecutable"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"${execPath}"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"args"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"--extensionDevelopmentPath=${workspaceFolder}"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"--extensionTestsPath=${workspaceFolder}/out/test"')]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"outFiles"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"${workspaceFolder}/out/test/**/*.js"')]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[e._v('"preLaunchTask"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"npm: test-compile"')]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),n("p",[e._v("This configuration for running tests is the same for non-webpacked extensions. There is no reason to webpack unit tests because they are not part of the published portion of an extension.")]),e._v(" "),n("h2",{attrs:{id:"publishing"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#publishing","aria-hidden":"true"}},[e._v("#")]),e._v(" Publishing")]),e._v(" "),n("p",[e._v("Before publishing, you should update the "),n("code",[e._v(".vscodeignore")]),e._v(" file. Everything that's now bundled into the "),n("code",[e._v("dist/extension.js")]),e._v(" file can be excluded, usually the "),n("code",[e._v("out")]),e._v(" folder (in case you didn't delete it yet) and most importantly, the "),n("code",[e._v("node_modules")]),e._v(" folder.")]),e._v(" "),n("p",[e._v("A typical "),n("code",[e._v(".vscodeignore")]),e._v(" file looks like this:")]),e._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v(".vscode\nnode_modules\nout/\nsrc/\ntsconfig.json\nwebpack.config.js\n")])])]),n("h2",{attrs:{id:"migrate-an-existing-extension"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#migrate-an-existing-extension","aria-hidden":"true"}},[e._v("#")]),e._v(" Migrate an existing extension")]),e._v(" "),n("p",[e._v("Migrating an existing extension to use webpack is easy and similar to the getting started guide above. A real world sample that adopted webpack is the VS Code's References view through this "),n("a",{attrs:{href:"https://github.com/Microsoft/vscode-references-view/pull/50",target:"_blank",rel:"noopener noreferrer"}},[e._v("pull request"),n("OutboundLink")],1),e._v(".")]),e._v(" "),n("p",[e._v("There you can see:")]),e._v(" "),n("ul",[n("li",[e._v("Add "),n("code",[e._v("webpack")]),e._v(", "),n("code",[e._v("webpack-cli")]),e._v(", and "),n("code",[e._v("ts-loader")]),e._v(" as "),n("code",[e._v("devDependencies")]),e._v(".")]),e._v(" "),n("li",[e._v("Update npm scripts so that webpack is used for development.")]),e._v(" "),n("li",[e._v("Update the debugger configuration "),n("code",[e._v("launch.json")]),e._v(" file.")]),e._v(" "),n("li",[e._v("Add and tweak the "),n("code",[e._v("webpack.config.js")]),e._v(" configuration file.")]),e._v(" "),n("li",[e._v("Update "),n("code",[e._v(".vscodeignore")]),e._v(" to exclude "),n("code",[e._v("node_modules")]),e._v(" and intermediate output files.")]),e._v(" "),n("li",[e._v("Enjoy an extension that installs and loads much faster!")])]),e._v(" "),n("h2",{attrs:{id:"troubleshooting"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting","aria-hidden":"true"}},[e._v("#")]),e._v(" Troubleshooting")]),e._v(" "),n("h3",{attrs:{id:"minification"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#minification","aria-hidden":"true"}},[e._v("#")]),e._v(" Minification")]),e._v(" "),n("p",[e._v("Bundling in "),n("code",[e._v("production")]),e._v(" mode also performs code minification. Minification compacts source code by removing whitespace and comments and by changing variable  and function names into something ugly but short. Source code that uses "),n("code",[e._v("Function.prototype.name")]),e._v(" works differently and so you might have to disable minification.")]),e._v(" "),n("h3",{attrs:{id:"webpack-critical-dependencies"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webpack-critical-dependencies","aria-hidden":"true"}},[e._v("#")]),e._v(" webpack critical dependencies")]),e._v(" "),n("p",[e._v("When running webpack, you might encounter a warning like "),n("strong",[e._v("Critical dependencies: the request of a dependency is an expression")]),e._v(". Such warnings must be taken seriously and likely your bundle won't work. The message means that webpack cannot statically determine how to bundle some dependency. This is usually caused by a dynamic "),n("code",[e._v("require")]),e._v(" statement, for example "),n("code",[e._v("require(someDynamicVariable)")]),e._v(".")]),e._v(" "),n("p",[e._v("To address the warning, you should either:")]),e._v(" "),n("ul",[n("li",[e._v("Try to make the dependency static so that it can be bundled.")]),e._v(" "),n("li",[e._v("Exclude that dependency via the "),n("code",[e._v("externals")]),e._v(" configuration. Also make sure that those JavaScript files aren't excluded from the packaged extension, using a negated glob pattern in "),n("code",[e._v(".vscodeignore")]),e._v(", for example "),n("code",[e._v("!node_modules/mySpecialModule")]),e._v(".")])]),e._v(" "),n("h2",{attrs:{id:"next-steps"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#next-steps","aria-hidden":"true"}},[e._v("#")]),e._v(" Next steps")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"/docs/editor/extension-gallery"}},[e._v("Extension Marketplace")]),e._v(" - Learn more about VS Code's public extension Marketplace.")]),e._v(" "),n("li",[n("a",{attrs:{href:"/api/working-with-extensions/testing-extension"}},[e._v("Testing Extensions")]),e._v(" - Add tests to your extension project to ensure high quality.")]),e._v(" "),n("li",[n("a",{attrs:{href:"/api/working-with-extensions/continuous-integration"}},[e._v("Continuous Integration")]),e._v(" - Learn how to run extension CI builds on Azure Pipelines.")])])])}),[],!1,null,null,null);t.default=a.exports}}]);