(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{256:function(t,e,s){"use strict";s.r(e);var n=s(0),a=Object(n.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"supporting-remote-development"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#supporting-remote-development","aria-hidden":"true"}},[t._v("#")]),t._v(" Supporting Remote Development")]),t._v(" "),s("p",[s("strong",[s("a",{attrs:{href:"/docs/remote/remote-overview"}},[t._v("Visual Studio Code Remote Development")])]),t._v(" allows you to transparently interact with source code and runtime environments sitting on other machines (whether virtual or physical). This means you can use the same VS Code extensions you love even while working in remote workspaces.")]),t._v(" "),s("p",[t._v("This article summarizes what extension authors need to know about VS Code Remote Development. This includes the "),s("a",{attrs:{href:"#architecture-and-extension-types"}},[t._v("VS Code Remote Development extension architecture")]),t._v(", how to "),s("a",{attrs:{href:"#testing-and-debugging-your-extension"}},[t._v("test your extension")]),t._v(" in remote workspaces, and recommendations on "),s("a",{attrs:{href:"#common-problems"}},[t._v("what to do if your extension does not work properly when being run remotely")]),t._v(". While many extensions will work in remote workspaces without any modifications, you may need to make changes so that your extension works properly in all environments, although these changes are often fairly minor.")]),t._v(" "),s("h2",{attrs:{id:"architecture-and-extension-types"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#architecture-and-extension-types","aria-hidden":"true"}},[t._v("#")]),t._v(" Architecture and extension types")]),t._v(" "),s("p",[t._v("In order to make remote development as transparent as possible to users, VS Code distinguishes two classes of extensions:")]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("UI Extensions")]),t._v(": These extensions make contributions to the VS Code user interface and are always run on the user's local machine. UI Extensions cannot directly access files in the workspace, or run scripts/tools installed in that workspace or on the machine. Example UI Extensions include: themes, snippets, language grammars, and keymaps.")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("Workspace Extensions")]),t._v(": These extensions are run on the same machine as where the workspace is located. When in a local workspace, Workspace Extensions are run on the local machine. When in a remote workspace, Workspace Extensions are run on the remote machine. Workspace Extensions can access files in the workspace to provide rich, multi-file language services, debugger support, or perform complex operations on multiple files in workspace (either themselves or by invoking scripts/tools). While Workspace extensions do not focus on UI customization, they can contribute explorers, views, and other UI elements as well.")])])]),t._v(" "),s("p",[t._v("When a user installs an extension, VS Code automatically installs it to the correct location based on its type: UI Extensions are run by VS Code's "),s("a",{attrs:{href:"/api/advanced-topics/extension-host"}},[t._v("local Extension Host")]),t._v(", while Workspace Extensions are run by a "),s("strong",[t._v("Remote Extension Host")]),t._v(" that sits in a small "),s("strong",[t._v("VS Code Server")]),t._v(". This server is automatically installed (or updated) when you open a folder in Windows Subsystem for Linux (WSL), in a container, or on a remote SSH host. (VS Code also automatically manages starting and stopping the server, so users are often not aware of its presence.)")]),t._v(" "),s("p",[s("img",{attrs:{src:"images/remote-extensions/architecture.png",alt:"Architecture diagram"}})]),t._v(" "),s("p",[t._v("VS Code APIs are designed to automatically run on the correct machine (either local or remote) when called from both UI or Workspace Extensions. However, if your extension uses APIs not provided by VS Code — such using Node APIs or running shell scripts — it may not work properly when run remotely. We recommend that you test that all features of your extension work properly in both local and remote workspaces.")]),t._v(" "),s("h2",{attrs:{id:"testing-and-debugging-your-extension"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#testing-and-debugging-your-extension","aria-hidden":"true"}},[t._v("#")]),t._v(" Testing and debugging your extension")]),t._v(" "),s("p",[t._v("This section explains how to test and debug a development version of your extension in remote workspaces. Specifically, we will look at how to test an extension using a local "),s("a",{attrs:{href:"/docs/remote/containers"}},[t._v("dev container")]),t._v(". Dev containers are cross-platform, easy to set up, and restrict port and file system access. Combined with a thin OS footprint, dev containers provide the environment where your extension is most likely to hit a problem (if it has one at all). WSL, on the other hand, is typically the least restrictive, with SSH being somewhere in the middle. In most cases, only small adjustments are needed to resolve issues. See "),s("a",{attrs:{href:"#common-problems"}},[t._v("common problems")]),t._v(" for more information.")]),t._v(" "),s("h3",{attrs:{id:"installing-a-development-version-of-your-extension"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installing-a-development-version-of-your-extension","aria-hidden":"true"}},[t._v("#")]),t._v(" Installing a development version of your extension")]),t._v(" "),s("p",[t._v("Currently, any time VS Code automatically installs an extension on an SSH host or inside a container or WSL, the Marketplace version is used (and not the version already installed on your local machine). While this makes sense in most situations, you may want to use an unpublished version of your extension for testing. To install an unpublished version of your extension, you can package the extension as a "),s("code",[t._v("VSIX")]),t._v(" and manually install it into a VS Code window that is already connected to a running remote environment.")]),t._v(" "),s("p",[t._v("Follow these steps:")]),t._v(" "),s("ol",[s("li",[t._v("If this is a published extension, you may want to add "),s("code",[t._v('"extensions.autoUpdate": false')]),t._v(" to "),s("code",[t._v("settings.json")]),t._v(" to prevent it from auto-updating to the latest Marketplace version.")]),t._v(" "),s("li",[t._v("Next, use "),s("code",[t._v("vsce package")]),t._v(" to package your extension as a VSIX.")]),t._v(" "),s("li",[t._v("Connect to a "),s("a",{attrs:{href:"/docs/remote/containers"}},[t._v("development container")]),t._v(", "),s("a",{attrs:{href:"/docs/remote/ssh"}},[t._v("SSH host")]),t._v(", or "),s("a",{attrs:{href:"/docs/remote/wsl"}},[t._v("WSL environment")]),t._v(".")]),t._v(" "),s("li",[t._v("Use the "),s("strong",[t._v("Install from VSIX...")]),t._v(" command available in the Extensions view "),s("strong",[t._v("More Actions")]),t._v(" ("),s("code",[t._v("...")]),t._v(") menu to install the extension in this specific window (not a local one).")]),t._v(" "),s("li",[t._v("Reload when prompted.")])]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("Tip:")]),t._v(" Once installed, you can use the "),s("strong",[t._v("Developer: Show Running Extensions")]),t._v(" command to see whether VS Code is running the extension locally or remotely.")])]),t._v(" "),s("h3",{attrs:{id:"debugging-your-extension-in-a-remote-environment"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#debugging-your-extension-in-a-remote-environment","aria-hidden":"true"}},[t._v("#")]),t._v(" Debugging your extension in a remote environment")]),t._v(" "),s("p",[t._v("Normally when you build an extension, you edit, launch, and debug it all on your local machine. Debugging your extension in a remote environment follows this same pattern. You will just edit, launch, and debug your extension all on a remote machine, container, or in WSL instead of your local machine.")]),t._v(" "),s("h4",{attrs:{id:"using-a-development-container"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-a-development-container","aria-hidden":"true"}},[t._v("#")]),t._v(" Using a development container")]),t._v(" "),s("p",[t._v("You can edit and debug your extension in a container by following these steps.")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Add the Node.js dev container definition to your extension folder by pressing "),s("code",[t._v("kbstyle(F1)")]),t._v(", selecting the "),s("strong",[t._v("Remote-Containers: Create Configuration File...")]),t._v(" command, and picking "),s("strong",[t._v("Node.js 8 & TypeScript")]),t._v(" (or just Node.js 8 if you are not using TypeScript). This will define the container you will use edit, debug, and test the extension.")])]),t._v(" "),s("li",[s("p",[t._v("After this command runs, you can modify the contents of the "),s("code",[t._v(".devcontainer")]),t._v(" folder to include additional build or runtime requirements. See the in-depth "),s("a",{attrs:{href:"/docs/remote/containers#_indepth-setting-up-a-folder-to-run-in-a-container"}},[t._v("Containers")]),t._v(" documentation for details.")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("[Optional]")]),t._v(" Edit your "),s("code",[t._v("launch.json")]),t._v(" to add a second argument to the "),s("code",[t._v("args")]),t._v(" property that points to the path of a test project / test data in your workspace folder or another path inside the container. For example, if your test data is in a "),s("code",[t._v("data")]),t._v(" folder in your workspace, you would add "),s("code",[t._v("${workspaceFolder}/data")]),t._v(" as follows:")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("Note:")]),t._v(" You "),s("strong",[t._v("cannot")]),t._v(" use "),s("code",[t._v("${workspaceFolder}")]),t._v(" alone for this second argument.")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Launch Extension"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"extensionHost"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"request"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"launch"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"runtimeExecutable"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"${execPath}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"args"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"--extensionDevelopmentPath=${workspaceFolder}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"${workspaceFolder}/data"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"stopOnEntry"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"sourceMaps"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"outFiles"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"${workspaceFolder}/dist/**/*.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"preLaunchTask"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"npm"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("li",[s("p",[t._v("Run "),s("strong",[t._v("Remote-Containers: Reopen Folder in Container")]),t._v(" and in a moment, VS Code will set up the container and connect. You will now be able to develop your source code from inside the container just as you would in the local case.")])]),t._v(" "),s("li",[s("p",[t._v("Finally, press "),s("code",[t._v("kbstyle(F5)")]),t._v(" or use the "),s("strong",[t._v("Debug view")]),t._v(" to launch the extension inside this same container and attach the debugger. You will be able to interact with it just as you would in the local case, but from inside the development container you defined in step 1 instead.")])])]),t._v(" "),s("h4",{attrs:{id:"using-ssh-or-wsl"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-ssh-or-wsl","aria-hidden":"true"}},[t._v("#")]),t._v(" Using SSH or WSL")]),t._v(" "),s("p",[t._v("You can edit and debug your extension on a remote "),s("a",{attrs:{href:"/docs/remote/ssh"}},[t._v("SSH host")]),t._v(" or in "),s("a",{attrs:{href:"/docs/remote/wsl"}},[t._v("WSL")]),t._v(" by following similar steps to the container case.")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("For SSH, you'll need to instead open a copy of the extension project on the remote host (for example, by using the "),s("strong",[t._v("Remote-SSH: Connect to Host...")]),t._v(" command, and then "),s("strong",[t._v("File")]),t._v(" > "),s("strong",[t._v("Open")]),t._v(" to select the cloned copy of the extension.) For WSL, open the local folder containing your extension project in WSL (for example by using "),s("strong",[t._v("File")]),t._v(" > "),s("strong",[t._v("New WSL Window")]),t._v(" and then "),s("strong",[t._v("File")]),t._v(" > "),s("strong",[t._v("Open")]),t._v(" to select the folder).")])]),t._v(" "),s("li",[s("p",[t._v("Once the folder is open on the SSH host / in WSL, you can edit your source code as you would in the local case.")])]),t._v(" "),s("li",[s("p",[t._v("Finally, press "),s("code",[t._v("kbstyle(F5)")]),t._v(" or use the "),s("strong",[t._v("Debug view")]),t._v(" to launch the extension and attach the debugger as you would locally. The window that appears now contains your extension running on the SSH Host / in WSL with the debugger attached to it.")])])]),t._v(" "),s("h2",{attrs:{id:"common-problems"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#common-problems","aria-hidden":"true"}},[t._v("#")]),t._v(" Common problems")]),t._v(" "),s("p",[t._v("VS Code's APIs are designed to automatically run in the right location regardless of where your extension happens to be located. With this in mind, there are a few APIs that will help you avoid unexpected behaviors.")]),t._v(" "),s("h3",{attrs:{id:"incorrect-execution-location"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#incorrect-execution-location","aria-hidden":"true"}},[t._v("#")]),t._v(" Incorrect execution location")]),t._v(" "),s("p",[t._v("If your extension is not functioning as expected, it may be running in the wrong location. Most commonly, this shows up as an extension running remotely when you expect it to only be run locally. You can use the "),s("strong",[t._v("Developer: Show Running Extensions")]),t._v(" command from the Command Palette ("),s("code",[t._v("kbstyle(F1)")]),t._v(") to see where an extension is running.")]),t._v(" "),s("p",[t._v("If the "),s("strong",[t._v("Developer: Show Running Extensions")]),t._v(" command shows that a UI extension is incorrectly being treated as a workspace extension or vice versa, try setting the "),s("code",[t._v("extensionKind")]),t._v(" property in your extension's "),s("a",{attrs:{href:"/api/get-started/extension-anatomy#extension-manifest"}},[s("code",[t._v("package.json")])]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"extensionKind"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ui"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[s("code",[t._v('"extensionKind": "ui"')]),t._v(" — Forces the extension to be a UI extension that is always run on the user's local machine.")]),t._v(" "),s("li",[s("code",[t._v('"extensionKind": "workspace"')]),t._v(" — Forces the extension to be a workspace extension that will be run remotely by the VS Code Server for remote workspaces.")])]),t._v(" "),s("p",[t._v("You can also quickly "),s("strong",[t._v("test")]),t._v(" the effect of changing an extension's kind with the "),s("code",[t._v("remote.extensionKind")]),t._v(" "),s("a",{attrs:{href:"/docs/getstarted/settings"}},[t._v("setting")]),t._v(". This setting is a map of extension IDs to extension kinds. For example, if you wish to force the "),s("a",{attrs:{href:"https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-cosmosdb",target:"_blank",rel:"noopener noreferrer"}},[t._v("Azure Cosmos DB"),s("OutboundLink")],1),t._v(" extension to be a UI extension (instead of its Workspace default) and the "),s("a",{attrs:{href:"https://marketplace.visualstudio.com/items?itemName=msjsdiag.debugger-for-chrome",target:"_blank",rel:"noopener noreferrer"}},[t._v("Debugger for Chrome"),s("OutboundLink")],1),t._v(" to be a workspace extension (instead of its UI default), you would set:")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"remote.extensionKind"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ms-azuretools.vscode-cosmosdb"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ui"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"msjsdiag.debugger-for-chrome"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"workspace"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("Using "),s("code",[t._v("remote.extensionKind")]),t._v(" allows you to quickly test published versions of extensions without having to modify their "),s("code",[t._v("package.json")]),t._v(" and rebuild them.")]),t._v(" "),s("h3",{attrs:{id:"persisting-extension-data-or-state"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#persisting-extension-data-or-state","aria-hidden":"true"}},[t._v("#")]),t._v(" Persisting extension data or state")]),t._v(" "),s("p",[t._v("In some cases, your extension may need to persist state information that does not belong in "),s("code",[t._v("settings.json")]),t._v(" or a separate workspace configuration file (for example "),s("code",[t._v(".eslintrc")]),t._v("). To solve this problem, VS Code provides a set of helpful storage properties on the "),s("code",[t._v("vscode.ExtensionContext")]),t._v(" object passed to your extension during activation. If your extension already takes advantage of these properties, it should continue to function regardless of where it runs.")]),t._v(" "),s("p",[t._v("However, if your extension relies on current VS Code pathing conventions (for example "),s("code",[t._v("~/.vscode")]),t._v(") or the presence of certain OS folders (for example "),s("code",[t._v("~/.config/Code")]),t._v(" on Linux) to persist data, you may run into problems. Fortunately, it should be simple to update your extension and avoid these challenges.")]),t._v(" "),s("p",[t._v("If you are persisting simple key-value pairs, you can store workspace specific or global state information using "),s("code",[t._v("vscode.ExtensionContext.workspaceState")]),t._v(" or "),s("code",[t._v("vscode.ExtensionContext.globalState")]),t._v(" respectively. If your data is more complicated than key-value pairs, the  "),s("code",[t._v("globalStoragePath")]),t._v(" and "),s("code",[t._v("storagePath")]),t._v(' properties provide "safe" paths that you can use to read/write global workspace-specific information in a file.')]),t._v(" "),s("p",[t._v("These APIs were added in VS Code 1.31. To use them, start by updating your "),s("code",[t._v("engines.vscode")]),t._v(" value in "),s("code",[t._v("package.json")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"engines"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"vscode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^1.31.0"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("Now when you publish your extension, only users on VS Code 1.31 or newer will get the updated version.")]),t._v(" "),s("p",[t._v("To use the APIs:")]),t._v(" "),s("div",{staticClass:"language-TypeScript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" vscode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vscode'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" fs "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("activate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExtensionContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subscriptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("commands"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerCommand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myAmazingExtension.persistWorkspaceData'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Create the extension's workspace storage folder if it doesn't already exist")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("existsSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("storagePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdirSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("storagePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Write a file to the workspace storage folder")]),t._v("\n        fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("storagePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'workspace-data.json'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" now"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subscriptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("commands"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerCommand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myAmazingExtension.persistGlobalData'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Create the extension's global (cross-workspace) folder if it doesn't already exist")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("existsSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("globalStoragePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdirSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("globalStoragePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Write a file to the global storage folder for the extension")]),t._v("\n        fs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeFileSync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("globalStoragePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'global-data.json'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" now"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("now")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"persisting-secrets"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#persisting-secrets","aria-hidden":"true"}},[t._v("#")]),t._v(" Persisting secrets")]),t._v(" "),s("p",[t._v("If your Workspace Extension needs to persist passwords or other secrets, you may want to use your local operating system's secret store (Windows Cert Store, the macOS KeyChain, a "),s("code",[t._v("libsecret")]),t._v("-based keyring on Linux) rather than the one on the remote machine. Further, on Linux you may be relying on "),s("code",[t._v("libsecret")]),t._v(" and by extension "),s("code",[t._v("gnome-keyring")]),t._v(" to store your secrets, and this does not typically work well on server distros or in a container.")]),t._v(" "),s("p",[t._v("Visual Studio Code does not provide a secret persistence mechanism itself, but many extension authors have opted to use the "),s("a",{attrs:{href:"https://www.npmjs.com/package/keytar",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("keytar")]),t._v(" node module"),s("OutboundLink")],1),t._v(" for this purpose. For this reason, VS Code includes "),s("code",[t._v("keytar")]),t._v(" and will "),s("strong",[t._v("automatically and transparently")]),t._v(" run it locally if referenced in a Workspace Extension. That way you can always take advantage of the local OS keychain / keyring / cert store and avoid the problems mentioned above.")]),t._v(" "),s("p",[t._v("For example:")]),t._v(" "),s("div",{staticClass:"language-typescript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" vscode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vscode'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCoreNodeModule")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("moduleName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("appRoot"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("/node_modules.asar/")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("moduleName"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("appRoot"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("/node_modules/")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("moduleName"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" undefined"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Use it")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" keytar "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCoreNodeModule")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'keytar'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" keytar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setPassword")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my-service-name'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my-account'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'iamal337d00d'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" password "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" keytar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPassword")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my-service-name'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my-account'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"using-the-clipboard"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-the-clipboard","aria-hidden":"true"}},[t._v("#")]),t._v(" Using the clipboard")]),t._v(" "),s("p",[t._v("Historically, extension authors have used Node.js modules such as "),s("code",[t._v("clipboardy")]),t._v(" to interact with the clipboard. Unfortunately, if you use these modules in a Workspace Extension, they will use the remote clipboard instead of the user's local one.")]),t._v(" "),s("p",[t._v("The VS Code clipboard API solves this problem. It is always run locally, regardless of the type of extension that calls it. This API was added in VS Code 1.30, so to use it, update the "),s("code",[t._v("engines.vscode")]),t._v(" value in "),s("code",[t._v("package.json")]),t._v(" and make sure you have the "),s("a",{attrs:{href:"/api/get-started/extension-anatomy#extension-manifest"}},[t._v("correct VS Code API typings")]),t._v(" installed:")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"engines"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"vscode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^1.30.0"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("Now when you publish your extension, only users on VS Code 1.30 or newer will get the updated version.")]),t._v(" "),s("p",[t._v("To use the VS Code clipboard API in an extension:")]),t._v(" "),s("div",{staticClass:"language-typescript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" vscode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vscode'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("activate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExtensionContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subscriptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("commands"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerCommand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myAmazingExtension.clipboardIt'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Read from clipboard")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clipboard"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readText")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Write to clipboard")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clipboard"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeText")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("It looks like you're copying \"")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("text"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('". Would you like help?')]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"opening-something-in-a-local-browser-or-application"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#opening-something-in-a-local-browser-or-application","aria-hidden":"true"}},[t._v("#")]),t._v(" Opening something in a local browser or application")]),t._v(" "),s("p",[t._v("Spawning a process or using a module like "),s("code",[t._v("opn")]),t._v(" to launch a browser or other application for particular URI can work well for local scenarios, but Workspace Extensions run remotely, which can cause the application to launch on the wrong side. VS Code Remote Development "),s("strong",[t._v("partially")]),t._v(" shims the "),s("code",[t._v("opn")]),t._v(" node module to allow existing extensions to function. You can call the module with a URI and VS Code will cause the default application for the URI to appear on the client side. However, this is not a complete implementation, as options are not support and a "),s("code",[t._v("child_process")]),t._v(" object is not returned.")]),t._v(" "),s("p",[t._v("Instead of relying on a third-party node module, we recommend extensions take advantage of the "),s("code",[t._v("vscode.env.openExternal")]),t._v(" method to launch the default registered application on your local operating system for given URI. Even better, "),s("code",[t._v("vscode.env.openExternal")]),t._v(" "),s("strong",[t._v("does automatic port forwarding!")]),t._v(" You can use it to point to a local web server on a remote machine and serve up content even if that port is blocked externally.")]),t._v(" "),s("p",[t._v("This API was added in VS Code 1.31. To get started, update your "),s("code",[t._v("engines.vscode")]),t._v(" value in "),s("code",[t._v("package.json")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"engines"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"vscode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^1.31.0"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("Now when you publish your extension, only users on VS Code 1.31 or newer will get the updated version.")]),t._v(" "),s("p",[t._v("To use the "),s("code",[t._v("vscode.env.openExternal")]),t._v(" API:")]),t._v(" "),s("div",{staticClass:"language-typescript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" vscode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vscode'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("activate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExtensionContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subscriptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("commands"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerCommand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myAmazingExtension.openExternal'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Example 1 - Open the VS Code homepage in the default browser.")]),t._v("\n        vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("openExternal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Uri"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://code.visualstudio.com'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Example 2 - Open the default email application.")]),t._v("\n        vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("openExternal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Uri"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mailto:vscode@microsoft.com'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"communicating-between-extensions-using-commands"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#communicating-between-extensions-using-commands","aria-hidden":"true"}},[t._v("#")]),t._v(" Communicating between extensions using commands")]),t._v(" "),s("p",[t._v("Some extensions return APIs as a part of their activation that are intended for use by other extensions (via "),s("code",[t._v("vscode.extension.getExtension(extensionName).exports")]),t._v("). While these will work if all extensions involved are on the same side (either all UI Extensions or all Workspace Extensions), these will not work between UI and Workspace Extensions.")]),t._v(" "),s("p",[t._v("Fortunately, VS Code automatically routes any executed commands to the correct extension regardless of its location. You can freely invoke any command (including those provided by other extensions) without worrying about impacts.")]),t._v(" "),s("p",[t._v('If you have a set of extensions that need to interact with one another, exposing functionality using a private command can help you avoid unexpected impacts. However, any objects you pass in as parameters will be "stringified" ('),s("code",[t._v("JSON.stringify")]),t._v(') before being transmitted, so the object cannot have cyclic references and will end up as a "plain old javascript object" on the other side.')]),t._v(" "),s("p",[t._v("For example:")]),t._v(" "),s("div",{staticClass:"language-typescript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" vscode "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vscode'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("activate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExtensionContext")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Register the private echo command")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" echoCommand "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("commands"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerCommand")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'_private.command.called.echo'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    context"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subscriptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("echoCommand"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("See the "),s("a",{attrs:{href:"/api/extension-guides/command"}},[t._v("command API guide")]),t._v(" for details on working with commands.")]),t._v(" "),s("h2",{attrs:{id:"using-the-webview-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-the-webview-api","aria-hidden":"true"}},[t._v("#")]),t._v(" Using the Webview API")]),t._v(" "),s("p",[t._v("Like the clipboard API, the "),s("a",{attrs:{href:"/api/extension-guides/webview"}},[t._v("Webview API")]),t._v(" is always run on the user's local machine, even when used from a Workspace extension. This means that many webview-based extensions should just work, even when used in remote workspaces. However there are some considerations to be aware of to make sure that your webview extension works properly when run remotely.")]),t._v(" "),s("h3",{attrs:{id:"accessing-localhost"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#accessing-localhost","aria-hidden":"true"}},[t._v("#")]),t._v(" Accessing localhost")]),t._v(" "),s("p",[t._v("By default, "),s("code",[t._v("localhost")]),t._v(" inside a webview resolves to the user's local machine. This means that for a remotely running workspace extension, the webviews it creates would not be able to access local servers spawned by the extension. Even if you use the IP of the machine, the ports you are connecting to will typically be blocked by default in a cloud VM or a container. Here's an illustration of the problem:")]),t._v(" "),s("p",[s("img",{attrs:{src:"images/remote-extensions/webview-problem.png",alt:"Webview problem"}})]),t._v(" "),s("p",[t._v("You can work around this by using the webview "),s("a",{attrs:{href:"/api/extension-guides/webview#scripts-and-message-passing"}},[t._v("message passing")]),t._v(" API instead of accessing localhost directly. Alternatively, you can "),s("strong",[t._v("add a port mapping")]),t._v(" to your webview so that certain ports are transparently forwarded to the remote machine where the extension is running.")]),t._v(" "),s("p",[t._v("Port mapping maps a localhost port used inside your webview to an arbitrary port on the machine where your extension is running. If your workspace extension is running remotely and defines a port mapping, traffic will be automatically and securely forwarded from the local machine to the remote machine. If your extension is running locally, a port mapping simply remaps one localhost port to another. Webview port mapping works for both UI and Workspace Extensions, and in both local and remote workspaces.")]),t._v(" "),s("p",[t._v("The port mapping API was added in VS Code 1.34. To use it, start by updating the "),s("code",[t._v("engines.vscode")]),t._v(" value in your extension's "),s("code",[t._v("package.json")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"engines"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"vscode"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^1.34.0"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("Now when you publish your extension, only users on VS Code 1.34 or newer will get the updated version.")]),t._v(" "),s("p",[t._v("To use a port mapping, just pass in a "),s("code",[t._v("portMapping")]),t._v(" object when you create your webview:")]),t._v(" "),s("div",{staticClass:"language-typescript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("STATIC_PORT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dynamicServerPort "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getExpressServerPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" webviewPort "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("STATIC_PORT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Create webview and pass portMapping in")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" panel "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWebviewPanel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'remoteMappingExample'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Remote Mapping Example'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    vscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ViewColumn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("One"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        portMapping"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// This maps localhost:3000 in the webview to the express server port on the remote host.")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" webviewPort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" webviewPort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" extensionHostPort"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" dynamicServerPort "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// Reference the "webviewPort" variable in any full URIs you reference in your HTML.')]),t._v("\npanel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webview"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('<!DOCTYPE html>\n    <body>\n        \x3c!-- This will resolve to the dynamic server port on the remote machine --\x3e\n        <img src="http://localhost:')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("webviewPort"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('/canvas.png">\n    </body>\n    </html>')]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Now the webview's traffic to "),s("code",[t._v("localhost:3000")]),t._v(" will be transparently routed to the remote machine using VS Code's existing secure communication channel:")]),t._v(" "),s("p",[s("img",{attrs:{src:"images/remote-extensions/webview-solution.png",alt:"Webview Solution"}})]),t._v(" "),s("h2",{attrs:{id:"using-native-node-js-modules"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-native-node-js-modules","aria-hidden":"true"}},[t._v("#")]),t._v(" Using native Node.js modules")]),t._v(" "),s("p",[t._v("Native modules bundled with (or dynamically acquired for) a VS Code extension must be recompiled "),s("a",{attrs:{href:"https://electronjs.org/docs/tutorial/using-native-node-modules",target:"_blank",rel:"noopener noreferrer"}},[t._v("using Electron's "),s("code",[t._v("electron-rebuild")]),s("OutboundLink")],1),t._v(". However, VS Code Server runs a standard (non-Electron) version of Node.js, which can cause binaries to fail when used remotely.")]),t._v(" "),s("p",[t._v("To solve this problem:")]),t._v(" "),s("ol",[s("li",[t._v('Include (or dynamically acquire) both sets of binaries (Electron and standard Node.js) for the "modules" version in Node.js that VS Code ships.')]),t._v(" "),s("li",[t._v("Check to see if "),s("code",[t._v("vscode.extensions.getExtension('your.extensionId').extensionKind === vscode.ExtensionKind.Workspace")]),t._v(" to set up the correct binaries based on whether the extension is running remotely or locally.")]),t._v(" "),s("li",[t._v("You may also want to add support for non-x86_64 targets and Alpine Linux at the same time by "),s("a",{attrs:{href:"#supporting-nonx8664-hosts-or-alpine-linux-containers"}},[t._v("following similar logic")])])]),t._v(" "),s("p",[t._v('You can find the "modules" version VS Code uses by going to '),s("strong",[t._v("Help > Developer Tools")]),t._v(" and typing "),s("code",[t._v("process.versions.modules")]),t._v(' in the console. However, to make sure native modules work seamlessly in different Node.js environments, you may want to compile the native modules against all possible Node.js "modules" versions and platforms you want support (Electron Node.js, official Node.js Windows/Darwin/Linux, all versions). The '),s("a",{attrs:{href:"https://github.com/tree-sitter/node-tree-sitter/releases/tag/v0.14.0",target:"_blank",rel:"noopener noreferrer"}},[t._v("node-tree-sitter"),s("OutboundLink")],1),t._v(" module is a good example of a module that does this well.")]),t._v(" "),s("h2",{attrs:{id:"supporting-non-x86-64-hosts-or-alpine-linux-containers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#supporting-non-x86-64-hosts-or-alpine-linux-containers","aria-hidden":"true"}},[t._v("#")]),t._v(" Supporting non-x86_64 hosts or Alpine Linux containers")]),t._v(" "),s("p",[t._v("If your extension is purely written in JavaScript/TypeScript, you may not need to do anything to add support for other processor architectures or the "),s("code",[t._v("musl")]),t._v(" based Alpine Linux to your extension.")]),t._v(" "),s("p",[t._v("However, if your extension works on Debian 9+, Ubuntu 16.04+, or RHEL / CentOS 7+ remote SSH hosts, containers, or WSL, but fails on supported non-x86_64 hosts (for example ARMv7l) or Alpine Linux containers, the extension may include x86_64 "),s("code",[t._v("glibc")]),t._v(" specific native code or runtimes that will fail on these architectures/operating systems.")]),t._v(" "),s("p",[t._v("For example, your extension may only include x86_64 compiled versions of native modules or runtimes. For Alpine Linux, the included native code or runtimes may not work due to "),s("a",{attrs:{href:"https://wiki.musl-libc.org/functional-differences-from-glibc.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("fundamental differences"),s("OutboundLink")],1),t._v(" between how "),s("code",[t._v("libc")]),t._v(" is implemented in Alpine Linux ("),s("code",[t._v("musl")]),t._v(") and other distributions ("),s("code",[t._v("glibc")]),t._v(").")]),t._v(" "),s("p",[t._v("To resolve this problem:")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("If you are dynamically acquiring compiled code, you can add support by detecting non-x86_64 targets using "),s("code",[t._v("process.arch")]),t._v(" and downloading versions compiled for the right architecture. If you are including binaries for all supported architectures inside your extension instead, you can use this logic to use the correct one.")])]),t._v(" "),s("li",[s("p",[t._v("For Alpine Linux, you can detect the operating system using  "),s("code",[t._v("await fs.exists('/etc/alpine-release')")]),t._v(" and once again download or use the correct binaries for a "),s("code",[t._v("musl")]),t._v(" based operating system.")])]),t._v(" "),s("li",[s("p",[t._v("If you'd prefer not to support these platforms, you can use the same logic to provide a good error message instead.")])])]),t._v(" "),s("p",[t._v("It is important to note that some third-party npm modules include native code that can cause this problem. So, in some cases you may need to work with the npm module author to add additional compilation targets.")]),t._v(" "),s("h2",{attrs:{id:"avoid-using-electron-modules"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#avoid-using-electron-modules","aria-hidden":"true"}},[t._v("#")]),t._v(" Avoid using Electron modules")]),t._v(" "),s("p",[t._v("While it can be convenient to rely on built-in Electron or VS Code modules not exposed by the extension API, it's important to note that VS Code Server runs a standard (non-Electron) version of Node.js. These modules will be missing when running remotely. There are a few exceptions, "),s("a",{attrs:{href:"#persisting-secrets"}},[t._v("like "),s("code",[t._v("keytar")])]),t._v(", where there is specific code in place to make them work.")]),t._v(" "),s("p",[t._v("Use base Node.js modules or modules in your extension VSIX to avoid these problems. If you absolutely have to use an Electron module, be sure to have a fallback if the module is missing.")]),t._v(" "),s("p",[t._v("The example below will use the Electron "),s("code",[t._v("original-fs")]),t._v(" node module if found, and fall back to the base Node.js "),s("code",[t._v("fs")]),t._v(" module if not.")]),t._v(" "),s("div",{staticClass:"language-typescript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("requireWithFallback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("electronModule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nodeModule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("electronModule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nodeModule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("requireWithFallback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'original-fs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("Try to avoid these situations whenever possible.")]),t._v(" "),s("h2",{attrs:{id:"known-issues"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#known-issues","aria-hidden":"true"}},[t._v("#")]),t._v(" Known issues")]),t._v(" "),s("p",[t._v("There are a few extension problems that could be resolved with some added functionality for Workspace Extensions. The following table is a list of known issues under consideration:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("Problem")]),t._v(" "),s("th",[t._v("Description")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("strong",[t._v("Blocked ports")])]),t._v(" "),s("td",[t._v("When working inside a Docker container or SSH server, ports are not automatically forwarded and there currently is no API to programmatically forward a port from an extension. Webviews can be adapted as described in "),s("a",{attrs:{href:"#using-the-webview-api"}},[t._v("Using the Webview API")]),t._v(", but other scenarios currently require users to manually forward or expose ports.")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("Cannot access / transfer remote workspace files to local machine")])]),t._v(" "),s("td",[t._v("Extensions that open workspace files in external applications may encounter errors because the external application cannot directly access the remote files. We are investigating options for how extensions might be able to transfer files from the remote workspace to solve this problem.")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("Cannot access attached devices from Workspace extension")])]),t._v(" "),s("td",[t._v("Extensions that access locally attached devices will be unable to connect to them when running remotely. We are investigating the best approach to solve this problem.")])])])]),t._v(" "),s("h2",{attrs:{id:"questions-and-feedback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#questions-and-feedback","aria-hidden":"true"}},[t._v("#")]),t._v(" Questions and feedback")]),t._v(" "),s("ul",[s("li",[t._v("See "),s("a",{attrs:{href:"/docs/remote/troubleshooting"}},[t._v("Tips and Tricks")]),t._v(" or the "),s("a",{attrs:{href:"/docs/remote/faq"}},[t._v("FAQ")]),t._v(".")]),t._v(" "),s("li",[t._v("Search for answers on "),s("a",{attrs:{href:"https://stackoverflow.com/questions/tagged/vscode-remote",target:"_blank",rel:"noopener noreferrer"}},[t._v("Stack Overflow"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://aka.ms/vscode-remote/feature-requests",target:"_blank",rel:"noopener noreferrer"}},[t._v("Upvote a feature or request a new one"),s("OutboundLink")],1),t._v(", search "),s("a",{attrs:{href:"https://aka.ms/vscode-remote/issues",target:"_blank",rel:"noopener noreferrer"}},[t._v("existing issues"),s("OutboundLink")],1),t._v(", or "),s("a",{attrs:{href:"https://aka.ms/vscode-remote/issues/new",target:"_blank",rel:"noopener noreferrer"}},[t._v("report a problem"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("li",[t._v("Contribute a "),s("a",{attrs:{href:"https://aka.ms/vscode-dev-containers",target:"_blank",rel:"noopener noreferrer"}},[t._v("development container definition"),s("OutboundLink")],1),t._v(" for others to use.")]),t._v(" "),s("li",[t._v("Contribute to "),s("a",{attrs:{href:"https://github.com/Microsoft/vscode-docs",target:"_blank",rel:"noopener noreferrer"}},[t._v("our documentation"),s("OutboundLink")],1),t._v(" or "),s("a",{attrs:{href:"https://github.com/Microsoft/vscode",target:"_blank",rel:"noopener noreferrer"}},[t._v("VS Code itself"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("li",[t._v("See our "),s("a",{attrs:{href:"https://aka.ms/vscode-remote/contributing",target:"_blank",rel:"noopener noreferrer"}},[t._v("CONTRIBUTING"),s("OutboundLink")],1),t._v(" guide for details.")])])])}),[],!1,null,null,null);e.default=a.exports}}]);